@using Beporsoft.Blazor.Charts.Common
@using Beporsoft.Blazor.Charts.Configuration
@using System.Drawing
<Chart @ref="_chart" Config="_config" Data="_data" />


@code {
    private Chart? _chart;

    private ConfigBase _config = new();
    private ChartData _data = new();


    protected override void OnInitialized()
    {
        _config = new ConfigBase();
        _config.Options
            .AddTitle("Bar chart")
            .AlignedAt(Align.Center)
            .WithFont(16);

        _config.AddCategoryAxis("x")
            .AddTitle("X axis");
        _config.AddLinearAxis("y")
            .AddTitle("Y axis");

        _config.Options
            .AddSubtitle($"A bar chart. It is possible to add multiple bar datasets to the same chart, using the samen or different scale. It is also possible to change" +
                            " the style of thebar, makin thinner")
            .WithFont(12);

        base.OnInitialized();
    }

    protected override Task OnParametersSetAsync()
    {

        return base.OnParametersSetAsync();
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {

            var dataset1 = BuildContinuousDataset();
            var dataset2 = BuildSecondContinuousDataset();
            // var dataset3 = BuildHighRangeDataset();

            _data.Labels = RandomDataGen.GetNumberSeries(1, 50).ToList();
            _data.Labels = new List<DateTime>() {
                new DateTime(2023, 1, 1),
                new DateTime(2023, 2, 1),
                new DateTime(2023, 3, 1),
                new DateTime(2023, 4, 1),
                new DateTime(2023, 5, 1),
                new DateTime(2023, 6, 1),
                new DateTime(2023, 7, 1),
                new DateTime(2023, 8, 1),
                new DateTime(2023, 9, 1),
                new DateTime(2023, 10, 1), };
            _data.Datasets.Add(dataset1);
            _data.Datasets.Add(dataset2);
            // _data.Datasets.Add(dataset3);
        }
    }

    private IChartDataset BuildContinuousDataset()
    {
        var data = RandomDataGen.GetDoubleSamples(0, 20, 10);
        var dataset = new BarDataset<double>("Bar", data);
        dataset.SetBarColor(Color.Green);

        return dataset;
    }

    private IChartDataset BuildSecondContinuousDataset()
    {
        var data = RandomDataGen.GetDoubleSamples(0, 20, 10);
        var dataset = new BarDataset<double>("Thinner bar", data);
        dataset.SetBarColor(Color.LightBlue);
        dataset.WidthPercentage = 0.2;

        return dataset;
    }



}
